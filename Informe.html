<!DOCTYPE html><html><head>
      <title>Informe</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="file:////home/juan/.vscode/extensions/shd101wyy.markdown-preview-enhanced-0.8.15/crossnote/dependencies/katex/katex.min.css">
      
      
      
      
      
      <style>
      code[class*=language-],pre[class*=language-]{color:#333;background:0 0;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.4;-moz-tab-size:8;-o-tab-size:8;tab-size:8;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:.8em;overflow:auto;border-radius:3px;background:#f5f5f5}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal;background:#f5f5f5}.token.blockquote,.token.comment{color:#969896}.token.cdata{color:#183691}.token.doctype,.token.macro.property,.token.punctuation,.token.variable{color:#333}.token.builtin,.token.important,.token.keyword,.token.operator,.token.rule{color:#a71d5d}.token.attr-value,.token.regex,.token.string,.token.url{color:#183691}.token.atrule,.token.boolean,.token.code,.token.command,.token.constant,.token.entity,.token.number,.token.property,.token.symbol{color:#0086b3}.token.prolog,.token.selector,.token.tag{color:#63a35c}.token.attr-name,.token.class,.token.class-name,.token.function,.token.id,.token.namespace,.token.pseudo-class,.token.pseudo-element,.token.url-reference .token.variable{color:#795da3}.token.entity{cursor:help}.token.title,.token.title .token.punctuation{font-weight:700;color:#1d3e81}.token.list{color:#ed6a43}.token.inserted{background-color:#eaffea;color:#55a532}.token.deleted{background-color:#ffecec;color:#bd2c00}.token.bold{font-weight:700}.token.italic{font-style:italic}.language-json .token.property{color:#183691}.language-markup .token.tag .token.punctuation{color:#333}.language-css .token.function,code.language-css{color:#0086b3}.language-yaml .token.atrule{color:#63a35c}code.language-yaml{color:#183691}.language-ruby .token.function{color:#333}.language-markdown .token.url{color:#795da3}.language-makefile .token.symbol{color:#795da3}.language-makefile .token.variable{color:#183691}.language-makefile .token.builtin{color:#0086b3}.language-bash .token.keyword{color:#0086b3}pre[data-line]{position:relative;padding:1em 0 1em 3em}pre[data-line] .line-highlight-wrapper{position:absolute;top:0;left:0;background-color:transparent;display:block;width:100%}pre[data-line] .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:hsla(24,20%,50%,.08);background:linear-gradient(to right,hsla(24,20%,50%,.1) 70%,hsla(24,20%,50%,0));pointer-events:none;line-height:inherit;white-space:pre}pre[data-line] .line-highlight:before,pre[data-line] .line-highlight[data-end]:after{content:attr(data-start);position:absolute;top:.4em;left:.6em;min-width:1em;padding:0 .5em;background-color:hsla(24,20%,50%,.4);color:#f4f1ef;font:bold 65%/1.5 sans-serif;text-align:center;vertical-align:.3em;border-radius:999px;text-shadow:none;box-shadow:0 1px #fff}pre[data-line] .line-highlight[data-end]:after{content:attr(data-end);top:auto;bottom:.4em}html body{font-family:'Helvetica Neue',Helvetica,'Segoe UI',Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ol,html body>ul{margin-bottom:16px}html body ol,html body ul{padding-left:2em}html body ol.no-list,html body ul.no-list{padding:0;list-style-type:none}html body ol ol,html body ol ul,html body ul ol,html body ul ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:700;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::after,html body code::before{letter-spacing:-.2em;content:'\00a0'}html body pre>code{padding:0;margin:0;word-break:normal;white-space:pre;background:0 0;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:after,html body pre code:before,html body pre tt:after,html body pre tt:before{content:normal}html body blockquote,html body dl,html body ol,html body p,html body pre,html body ul{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body code,html body pre{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview ul{list-style:disc}.markdown-preview ul ul{list-style:circle}.markdown-preview ul ul ul{list-style:square}.markdown-preview ol{list-style:decimal}.markdown-preview ol ol,.markdown-preview ul ol{list-style-type:lower-roman}.markdown-preview ol ol ol,.markdown-preview ol ul ol,.markdown-preview ul ol ol,.markdown-preview ul ul ol{list-style-type:lower-alpha}.markdown-preview .newpage,.markdown-preview .pagebreak{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center!important}.markdown-preview:not([data-for=preview]) .code-chunk .code-chunk-btn-group{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .status{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .output-div{margin-bottom:16px}.markdown-preview .md-toc{padding:0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link div,.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}.markdown-preview .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0;min-height:100vh}@media screen and (min-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{font-size:14px!important;padding:1em}}@media print{html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc{padding:0 16px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link div,html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% - 300px);padding:2em calc(50% - 457px - 300px / 2);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
      <!-- The content below will be included at the end of the <head> element. --><script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function () {
    // your code here
  });
</script></head><body for="html-export">
    
    
      <div class="crossnote markdown-preview  ">
      
<h1 id="centerarquitectura-de-computadoras-1-br-trabajo-practico-para-promocióncenter"><center>Arquitectura de Computadoras 1 <br> Trabajo Practico para Promoción</center> </h1>
<h2 id="integrantes">Integrantes </h2>
<ul>
<li>Schilliro Agustin</li>
<li>Dal Bello Juan Cruz</li>
</ul>
<br>
<h3 id="contador-de-programa">Contador de programa </h3>
<p>Se implementa el contador de programa por medio de un proceso explicito que se activa con el cambio de valor de la señal clk (asignada al puerto Clk del procesador). Este proceso reinicia el valor del registro de instruccion a 0 de manera asincrona si <code>reset</code> esta activado. Sino, asigna a <code>reg_pc</code> el valor de la direccion en memoria de la siguiente instruccion.</p>
<pre data-role="codeBlock" data-info="vhdl" class="language-vhdl vhdl"><code><span class="token keyword keyword-process">process</span> <span class="token punctuation">(</span>clk<span class="token punctuation">,</span> reset<span class="token punctuation">)</span>
    <span class="token keyword keyword-begin">begin</span>
        <span class="token keyword keyword-if">if</span> reset<span class="token operator">=</span> <span class="token number">'1'</span> <span class="token keyword keyword-then">then</span>
        reg_pc <span class="token operator">&lt;=</span> <span class="token punctuation">(</span><span class="token keyword keyword-others">others</span> <span class="token operator">=</span><span class="token operator">&gt;</span><span class="token number">'0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-elsif">elsif</span> <span class="token punctuation">(</span><span class="token function">rising_edge</span><span class="token punctuation">(</span>clk<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword keyword-then">then</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">rising_edge</span><span class="token punctuation">(</span>clk<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword keyword-then">then</span>
            reg_pc <span class="token operator">&lt;=</span> next_reg_pc<span class="token punctuation">;</span>
        <span class="token keyword keyword-end">end</span> <span class="token keyword keyword-if">if</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-end">end</span> <span class="token keyword keyword-if">if</span><span class="token punctuation">;</span> 
<span class="token keyword keyword-end">end</span> <span class="token keyword keyword-process">process</span><span class="token punctuation">;</span>
</code></pre><p>Para el calulculo de la posicion en memoria de la siguiente instruccion utilizamos procesos implicitos que simulan un MUX.</p>
<pre data-role="codeBlock" data-info="vhdl" class="language-vhdl vhdl"><code># Siguiente direccion de memoria <span class="token punctuation">(</span>direccionamiento normal<span class="token punctuation">)</span>
pc_4 <span class="token operator">&lt;=</span> reg_pc <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">;</span>
</code></pre><pre data-role="codeBlock" data-info="vhdl" class="language-vhdl vhdl"><code># Direccionamiento por beq
direccion_salto_condicional <span class="token operator">&lt;=</span> pc_4 <span class="token operator">+</span> inm_extended_shifted<span class="token punctuation">;</span>
</code></pre><pre data-role="codeBlock" data-info="vhdl" class="language-vhdl vhdl"><code># Direccionamiento pseudo<span class="token operator">-</span>inmediato por jump
direccion_salto_incondicional <span class="token operator">&lt;=</span> <span class="token function">pc_4</span><span class="token punctuation">(</span><span class="token number">31</span> <span class="token keyword keyword-downto">downto</span> <span class="token number">28</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> target_address_extended<span class="token punctuation">;</span>
</code></pre><pre data-role="codeBlock" data-info="vhdl" class="language-vhdl vhdl"><code># Eleccion entre las tres posibles direcciones de acuerdo a las flags activas
next_reg_pc <span class="token operator">&lt;=</span> <span class="token punctuation">(</span>direccion_salto_condicional<span class="token punctuation">)</span> <span class="token keyword keyword-when">when</span> <span class="token punctuation">(</span>Branch <span class="token operator">and</span> ALU_zero<span class="token punctuation">)</span> <span class="token keyword keyword-else">else</span> direccion_salto_incondicional <span class="token keyword keyword-when">when</span> <span class="token punctuation">(</span>Jump<span class="token punctuation">)</span> <span class="token keyword keyword-else">else</span> pc_4<span class="token punctuation">;</span>
</code></pre><p>Para el caso de la señal <code>inm_extended_shifted</code> se concatenaron los 30 bits menos significativos de la señal <code>inm_extended</code> con dos bits:</p>
<pre data-role="codeBlock" data-info="vhdl" class="language-vhdl vhdl"><code>inm_extended_shifted <span class="token operator">&lt;=</span> <span class="token function">inm_extended</span><span class="token punctuation">(</span><span class="token number">29</span> <span class="token keyword keyword-downto">downto</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token vhdl-vectors number">"00"</span><span class="token punctuation">;</span>
</code></pre><p>Y para <code>target_address_extended</code> se concatena toda la señal <code>target_address</code> con dos bits adicionales para que llegue a los 32 al concatenar esta señal con los 4 bits mas significativos de la direccion actual.</p>
<pre data-role="codeBlock" data-info="vhdl" class="language-vhdl vhdl"><code>target_address_extended <span class="token operator">&lt;=</span> <span class="token function">target_address</span><span class="token punctuation">(</span><span class="token number">25</span> <span class="token keyword keyword-downto">downto</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token vhdl-vectors number">"00"</span><span class="token punctuation">;</span>
</code></pre><br>
<h3 id="banco-de-registros">Banco de registros </h3>
<p>Para el banco de regitros, se asignaron sus dos entradas con las direcciones <code>rs</code> y <code>rt</code> de la instruccion. La flag que habilita la escritura proviene de la unidad de control, la cual se explica mas adelante. La salida 1 <code>data1_rd</code> se asignó a la entrada <code>a</code> de la ALU, y la salida 2 <code>data2_rd</code> entra en un MUX que define el valor <code>b</code> de la ALU. La entrada <code>data_write</code> se define por medio de un MUX.</p>
<pre data-role="codeBlock" data-info="vhdl" class="language-vhdl vhdl"><code><span class="token keyword keyword-Port">Port</span> <span class="token keyword keyword-map">map</span> <span class="token punctuation">(</span>
    clk      <span class="token operator">=</span><span class="token operator">&gt;</span> clk<span class="token punctuation">,</span> 
    reset    <span class="token operator">=</span><span class="token operator">&gt;</span> reset<span class="token punctuation">,</span> 
    wr       <span class="token operator">=</span><span class="token operator">&gt;</span> RegWrite<span class="token punctuation">,</span>
    reg1_rd  <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">I_DataIn</span><span class="token punctuation">(</span><span class="token number">25</span> <span class="token keyword keyword-downto">downto</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    reg2_rd  <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">I_DataIn</span><span class="token punctuation">(</span><span class="token number">20</span> <span class="token keyword keyword-downto">downto</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    reg_wr   <span class="token operator">=</span><span class="token operator">&gt;</span> reg_wr<span class="token punctuation">,</span>
    data_wr  <span class="token operator">=</span><span class="token operator">&gt;</span> data_Write<span class="token punctuation">,</span> 
    data1_rd <span class="token operator">=</span><span class="token operator">&gt;</span> data1_RegRead<span class="token punctuation">,</span>
    data2_rd <span class="token operator">=</span><span class="token operator">&gt;</span> data2_RegRead
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>Se usa un MUX para asignar el valor que se va a escribir en el banco de registros, eligiendo entre la salida de la memoria de datos o de la ALU.</p>
<pre data-role="codeBlock" data-info="vhdl" class="language-vhdl vhdl"><code>data_Write <span class="token operator">&lt;=</span> D_DataIn <span class="token keyword keyword-when">when</span> MemtoReg <span class="token keyword keyword-else">else</span> ALU_result<span class="token punctuation">;</span>
</code></pre><br>
<h3 id="alu">ALU </h3>
<p>En la ALU, las entrada <code>a</code> se asignó a la salida 1 del banco de registros, y la entrada <code>b</code> se define usando un MUX junto con el <code>offset</code> extendido de las instrucciones <code>tipo-I</code> y la flag correspondiente. La salida <code>zero</code> se usa como flag al momento de definir los saltos condicionales. El codigo de control se asigna por medio de un proceso explicito. La salida <code>result</code> se asigna a la entrada <code>Addr</code> de la memoria de datos, para el caso de las instrucciones <code>lw</code> y <code>sw</code>, y a la entrada de un MUX que define si se va a escribir desde la memoria de datos o desde la ALU.</p>
<pre data-role="codeBlock" data-info="vhdl" class="language-vhdl vhdl"><code>E_ALU<span class="token punctuation">:</span> ALU <span class="token keyword keyword-port">port</span> <span class="token keyword keyword-map">map</span><span class="token punctuation">(</span>
    a       <span class="token operator">=</span><span class="token operator">&gt;</span> data1_RegRead <span class="token punctuation">,</span> 
    b       <span class="token operator">=</span><span class="token operator">&gt;</span> ALU_oper_b <span class="token punctuation">,</span> 
    control <span class="token operator">=</span><span class="token operator">&gt;</span> ALU_control <span class="token punctuation">,</span>
    zero    <span class="token operator">=</span><span class="token operator">&gt;</span> ALU_zero <span class="token punctuation">,</span> 
    result  <span class="token operator">=</span><span class="token operator">&gt;</span> ALU_result<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>La entrada <code>b</code> de la ALU va a ser el valor correspondiente a la extension a 32 bits del <code>offset</code> de las instrucciones lw y sw para calcular la direccion de memoria de la cual se va a leer o en cual se va a escribir, si la flag <code>ALUSrc</code> esta activa, o la salida 2 <code>data2_rd</code> en el caso contrario.</p>
<pre data-role="codeBlock" data-info="vhdl" class="language-vhdl vhdl"><code>ALU_oper_b <span class="token operator">&lt;=</span> inm_extended <span class="token keyword keyword-when">when</span> ALUSrc <span class="token keyword keyword-else">else</span> data2_RegRead<span class="token punctuation">;</span>
</code></pre><p>El proceso explicito que define el codigo de operacion de la ALU usa la flag <code>ALUOp</code> y los bits del campo <code>funct</code> de la instruccion. En caso de una instruccion de <code>tipo-R</code>, el campo <code>funct</code> indica que operacion logica debe llevar a cambo el componente, y para el resto de operaciones se asigna el codigo correspondiente (de suma para <code>lw</code> y <code>sw</code> o de resta para <code>beq</code>).</p>
<pre data-role="codeBlock" data-info="vhdl" class="language-vhdl vhdl"><code><span class="token keyword keyword-process">process</span> <span class="token punctuation">(</span>ALUOp<span class="token punctuation">,</span> funct<span class="token punctuation">)</span>
<span class="token keyword keyword-begin">begin</span>
    <span class="token keyword keyword-case">case</span> ALUOp <span class="token keyword keyword-is">is</span>
        <span class="token keyword keyword-when">when</span> <span class="token vhdl-vectors number">"00"</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token comment">-- lw o sw</span>
            ALU_control <span class="token operator">&lt;=</span> <span class="token vhdl-vectors number">"010"</span><span class="token punctuation">;</span>
        
        <span class="token keyword keyword-when">when</span> <span class="token vhdl-vectors number">"01"</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token comment">-- branch</span>
            ALU_control <span class="token operator">&lt;=</span> <span class="token vhdl-vectors number">"110"</span><span class="token punctuation">;</span>
            
        <span class="token keyword keyword-when">when</span> <span class="token vhdl-vectors number">"10"</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token comment">-- tipo-R</span>
            <span class="token keyword keyword-case">case</span> funct <span class="token keyword keyword-is">is</span>
                <span class="token keyword keyword-when">when</span> <span class="token vhdl-vectors number">"100000"</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token comment">-- add</span>
                    ALU_control <span class="token operator">&lt;=</span> <span class="token vhdl-vectors number">"010"</span><span class="token punctuation">;</span>
                <span class="token keyword keyword-when">when</span> <span class="token vhdl-vectors number">"100010"</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token comment">-- sub</span>
                    ALU_control <span class="token operator">&lt;=</span> <span class="token vhdl-vectors number">"110"</span><span class="token punctuation">;</span>
                <span class="token keyword keyword-when">when</span> <span class="token vhdl-vectors number">"100100"</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token comment">-- and</span>
                    ALU_control <span class="token operator">&lt;=</span> <span class="token vhdl-vectors number">"000"</span><span class="token punctuation">;</span>
                <span class="token keyword keyword-when">when</span> <span class="token vhdl-vectors number">"100101"</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token comment">-- or</span>
                    ALU_control <span class="token operator">&lt;=</span> <span class="token vhdl-vectors number">"001"</span><span class="token punctuation">;</span>
                <span class="token keyword keyword-when">when</span> <span class="token vhdl-vectors number">"101010"</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token comment">-- slt</span>
                    ALU_control <span class="token operator">&lt;=</span> <span class="token vhdl-vectors number">"111"</span><span class="token punctuation">;</span>
                <span class="token keyword keyword-when">when</span> <span class="token keyword keyword-others">others</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token comment">-- codigo sin usar</span>
                    ALU_control <span class="token operator">&lt;=</span> <span class="token vhdl-vectors number">"011"</span><span class="token punctuation">;</span>
            <span class="token keyword keyword-end">end</span> <span class="token keyword keyword-case">case</span><span class="token punctuation">;</span>

        <span class="token keyword keyword-when">when</span> <span class="token keyword keyword-others">others</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token comment">-- ALUOp incorrecto</span>
            ALU_control <span class="token operator">&lt;=</span> <span class="token vhdl-vectors number">"011"</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-end">end</span> <span class="token keyword keyword-case">case</span><span class="token punctuation">;</span>
<span class="token keyword keyword-end">end</span> <span class="token keyword keyword-process">process</span><span class="token punctuation">;</span>
</code></pre><br>
<h3 id="unidad-de-control">Unidad de control </h3>
<p>Se generan las señales <code>RegWrite</code>, <code>RegDst</code>, <code>Branch</code>, <code>MemRead</code>, <code>MemtoReg</code>, <code>MemWrite</code>, <code>ALUSrc</code>, <code>Jump</code> y <code>ALUOp</code> por medio de un proceso explicito que toma los 6 bits mas significativos de la instruccion.</p>
<p><code>RegWrite</code>: habilita la escritura en el banco de registros.</p>
<p><code>RegDst</code>: habilita el registro de escritura <code>rt</code> o <code>rd</code>.</p>
<p><code>Branch</code>: habilita el salto condicional.</p>
<p><code>MemRead</code>: habilita la lectura de la memoria de datos.</p>
<p><code>MemtoReg</code>: habilita la escritura en el banco de registros de la salida de la memoria de datos (<code>lw</code>) o la salida de la ALU (<code>tipo-R</code>).</p>
<p><code>MemWrite</code>: habilita la escritura en la memoria de datos.</p>
<p><code>ALUSrc</code>: habilita la salida 2 del banco de registros o el <code>offset</code> extendido (<code>lw</code> y <code>sw</code>) para la entrada <code>b</code> de la ALU.</p>
<p><code>Jump</code>: habilita el salto incondicional.</p>
<p><code>ALUOp</code>: define (junto con el campo <code>funct</code> en el caso de las instrucciones de <code>tipo-R</code>) la operacion que va a ejecutar la ALU.</p>
<pre data-role="codeBlock" data-info="vhdl" class="language-vhdl vhdl"><code><span class="token keyword keyword-process">process</span> <span class="token punctuation">(</span>op<span class="token punctuation">)</span>
<span class="token keyword keyword-begin">begin</span>
    <span class="token keyword keyword-if">if</span> op <span class="token operator">=</span> <span class="token vhdl-vectors number">"000000"</span> <span class="token keyword keyword-then">then</span> <span class="token comment">-- instrucciones de tipo-R</span>
        RegWrite <span class="token operator">&lt;=</span> <span class="token number">'1'</span><span class="token punctuation">;</span>
        RegDst	 <span class="token operator">&lt;=</span> <span class="token number">'1'</span><span class="token punctuation">;</span>
        Branch	 <span class="token operator">&lt;=</span> <span class="token number">'0'</span><span class="token punctuation">;</span>
        MemRead	 <span class="token operator">&lt;=</span> <span class="token number">'0'</span><span class="token punctuation">;</span>
        MemtoReg <span class="token operator">&lt;=</span> <span class="token number">'0'</span><span class="token punctuation">;</span>
        MemWrite <span class="token operator">&lt;=</span> <span class="token number">'0'</span><span class="token punctuation">;</span>
        ALUSrc	 <span class="token operator">&lt;=</span> <span class="token number">'0'</span><span class="token punctuation">;</span>
        Jump	 <span class="token operator">&lt;=</span> <span class="token number">'0'</span><span class="token punctuation">;</span>
        ALUOp	 <span class="token operator">&lt;=</span> <span class="token vhdl-vectors number">"10"</span><span class="token punctuation">;</span>
        
    <span class="token keyword keyword-elsif">elsif</span> op <span class="token operator">=</span> <span class="token vhdl-vectors number">"100011"</span> <span class="token keyword keyword-then">then</span> <span class="token comment">-- lw</span>
        RegWrite <span class="token operator">&lt;=</span> <span class="token number">'1'</span><span class="token punctuation">;</span>
        RegDst	 <span class="token operator">&lt;=</span> <span class="token number">'0'</span><span class="token punctuation">;</span>
        Branch	 <span class="token operator">&lt;=</span> <span class="token number">'0'</span><span class="token punctuation">;</span>
        MemRead	 <span class="token operator">&lt;=</span> <span class="token number">'1'</span><span class="token punctuation">;</span>
        MemtoReg <span class="token operator">&lt;=</span> <span class="token number">'1'</span><span class="token punctuation">;</span>
        MemWrite <span class="token operator">&lt;=</span> <span class="token number">'0'</span><span class="token punctuation">;</span>
        ALUSrc	 <span class="token operator">&lt;=</span> <span class="token number">'1'</span><span class="token punctuation">;</span>
        Jump	 <span class="token operator">&lt;=</span> <span class="token number">'0'</span><span class="token punctuation">;</span>
        ALUOp	 <span class="token operator">&lt;=</span> <span class="token vhdl-vectors number">"00"</span><span class="token punctuation">;</span>
        
    <span class="token keyword keyword-elsif">elsif</span> op <span class="token operator">=</span> <span class="token vhdl-vectors number">"101011"</span> <span class="token keyword keyword-then">then</span> <span class="token comment">-- sw</span>
        RegWrite <span class="token operator">&lt;=</span> <span class="token number">'0'</span><span class="token punctuation">;</span>
        <span class="token comment">-- RegDst no importa</span>
        Branch	 <span class="token operator">&lt;=</span> <span class="token number">'0'</span><span class="token punctuation">;</span>
        MemRead	 <span class="token operator">&lt;=</span> <span class="token number">'0'</span><span class="token punctuation">;</span>
        <span class="token comment">-- MemtoReg no importa</span>
        MemWrite <span class="token operator">&lt;=</span> <span class="token number">'1'</span><span class="token punctuation">;</span>
        ALUSrc	 <span class="token operator">&lt;=</span> <span class="token number">'1'</span><span class="token punctuation">;</span>
        Jump	 <span class="token operator">&lt;=</span> <span class="token number">'0'</span><span class="token punctuation">;</span>
        ALUOp	 <span class="token operator">&lt;=</span> <span class="token vhdl-vectors number">"00"</span><span class="token punctuation">;</span>
        
    <span class="token keyword keyword-elsif">elsif</span> op <span class="token operator">=</span> <span class="token vhdl-vectors number">"000100"</span> <span class="token keyword keyword-then">then</span> <span class="token comment">-- beq</span>
        RegWrite <span class="token operator">&lt;=</span> <span class="token number">'0'</span><span class="token punctuation">;</span>
        <span class="token comment">-- RegDst no importa</span>
        Branch	 <span class="token operator">&lt;=</span> <span class="token number">'1'</span><span class="token punctuation">;</span>
        MemRead	 <span class="token operator">&lt;=</span> <span class="token number">'0'</span><span class="token punctuation">;</span>
        <span class="token comment">-- MemtoReg no importa</span>
        MemWrite <span class="token operator">&lt;=</span> <span class="token number">'0'</span><span class="token punctuation">;</span>
        ALUSrc	 <span class="token operator">&lt;=</span> <span class="token number">'0'</span><span class="token punctuation">;</span>
        Jump	 <span class="token operator">&lt;=</span> <span class="token number">'0'</span><span class="token punctuation">;</span>
        ALUOp	 <span class="token operator">&lt;=</span> <span class="token vhdl-vectors number">"01"</span><span class="token punctuation">;</span>
    
    <span class="token keyword keyword-elsif">elsif</span> op <span class="token operator">=</span> <span class="token vhdl-vectors number">"000010"</span> <span class="token keyword keyword-then">then</span> <span class="token comment">-- jump</span>
        RegWrite <span class="token operator">&lt;=</span> <span class="token number">'0'</span><span class="token punctuation">;</span>
        <span class="token comment">--RegDst no importa, no se va a guardar en el banco de regs</span>
        Branch	 <span class="token operator">&lt;=</span> <span class="token number">'0'</span><span class="token punctuation">;</span>
        MemRead	 <span class="token operator">&lt;=</span> <span class="token number">'0'</span><span class="token punctuation">;</span>
        <span class="token comment">--MemtoReg no importa</span>
        MemWrite <span class="token operator">&lt;=</span> <span class="token number">'0'</span><span class="token punctuation">;</span>
        <span class="token comment">--ALUSrc no importa</span>
        Jump	 <span class="token operator">&lt;=</span> <span class="token number">'1'</span><span class="token punctuation">;</span>
        <span class="token comment">--ALUOp no importa</span>
        
    <span class="token keyword keyword-else">else</span> <span class="token comment">-- codigo de instruccion incorrecto</span>
        RegWrite <span class="token operator">&lt;=</span> <span class="token number">'0'</span><span class="token punctuation">;</span>
        RegDst	 <span class="token operator">&lt;=</span> <span class="token number">'0'</span><span class="token punctuation">;</span>
        Branch	 <span class="token operator">&lt;=</span> <span class="token number">'0'</span><span class="token punctuation">;</span>
        MemRead	 <span class="token operator">&lt;=</span> <span class="token number">'0'</span><span class="token punctuation">;</span>
        MemtoReg <span class="token operator">&lt;=</span> <span class="token number">'0'</span><span class="token punctuation">;</span>
        MemWrite <span class="token operator">&lt;=</span> <span class="token number">'0'</span><span class="token punctuation">;</span>
        ALUSrc	 <span class="token operator">&lt;=</span> <span class="token number">'0'</span><span class="token punctuation">;</span>
        Jump	 <span class="token operator">&lt;=</span> <span class="token number">'0'</span><span class="token punctuation">;</span>
        ALUOp	 <span class="token operator">&lt;=</span> <span class="token vhdl-vectors number">"00"</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-end">end</span> <span class="token keyword keyword-if">if</span><span class="token punctuation">;</span>
<span class="token keyword keyword-end">end</span> <span class="token keyword keyword-process">process</span><span class="token punctuation">;</span>
</code></pre><br>
<h3 id="flanco-ascendente-y-descendente">Flanco ascendente y descendente </h3>
<p>La memoria del programa trabaja en flanco descendente asegurándose que el procesador tenga tiempo suficiente para capturar correctamente la siguiente instrucción. Esto permite que el ciclo de lectura y la decodificación estén alineados con el clk.<br>
El banco de registros trabaja en flanco descendente para poder actualizar su contenido de manera que los datos estén disponibles antes del siguiente ciclo de instrucción.<br>
Con la memoria de datos ocurre algo similar con el banco de registros, esta sincronizada con el procesamiento de la instrucción, y trabajando en flanco ascendente se asegura que la escritura este alineada con el ciclo de escritura posterior al procesamiento de la próxima instrucción.<br>
El contador del programa trabaja en flanco ascendente porque le permite sincronizar el cambio de la dirección de la instrucción con el inicio del ciclo de instrucción. En el flanco ascendente el procesador hace el cálculo para que la memoria de instrucción en flanco descendente la reciba.</p>

      </div>
      
      
    
    
    
    
    
    
  
    </body></html>